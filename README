Ver 147

---Changes
- Duration has been added
so now the green bar on the bottom of the screen is accurate.  I thought this would help the deleting problem but it didn't.

- Single form of code
so now this works with no changes on linux and windows

- ffmpeg entry in config file
allows you to move ffmpeg and allows a single version of code for multiple platforms

---Description

pyTivo lets you stream most videos from yout PC to your unhacked tivo. It uses the HMO server protocol. It will guess if your video is 4:3 or 16:9 and pad your video if it thinks it is needed (looked good on my tests). It will not transcode an mpeg that is supported by your tivo.

---Download

http://armooo.net/~armooo/pyTivo/pyTivo.zip

---Requirements

OS = Anything that will run python and ffmpeg, which I think is anything.  I have it running on linux, I know windows works as well.

Python - http://www.python.org/download/
- You need at least version 2.4 of python

pywin32 (only to install as a service) - http://sourceforge.net/project/showfiles.php?group_id=78018&package_id=79063 
- Windows users only and only if you intend to install as a service

---Usage

You need to edit pyTivo.conf in 3 places

1. ffmpeg=
2. [<name of share>]
3. path=

ffmpeg should be the full path to ffmpeg including filename.  For windows users the exe has been included and is in the plugins/video directory.
path is the absolute path to your media

run pyTivo.py

---To install as a service in Windows

run pyTivoService.py --startup auto install

---To remove service

run pyTivoService.py remove

---Known Problems

- Only one pyTivo server per network
GUID in beacons hardcoded. So only 1 server per network. This will be fixed soon.

- Max MPEG size
The max mpeg2 output size is 6000000000 bytes (hard coded in container.tmpl). 
It seems that unlike sending photos and music when sending video the tivo needs to know the size of video before hand. So we lie and tell the tivo that it is 6000000000 bytes. The tivo will stop downloading when it hits this size. If the download stops before it it reaches what it thinks is the end it will try resuming the download (HTTP Range header). I return a 404 when the tivo trys to resume and it will give up. You may see an error when you reach the end of the file.

- Files delete before you watch them
Currently the only way to end a stream to the TiVo involves sending a 404. This is true for all transcoders currently.  Some people will see an error at the end of all of their streamed videos which says "Transfer Interrupted" this is only becuase TiVo thinks the file is larger than it is.
As a side effect of this some peoples videos will also delete before they watch them.  As far as I can tell the only way to keep a file is to play it all the way to the end as it is streaming to you.  If the file finishes streaming and you are not watchin it, it will delete itself before you watch it.  
My only suggestion is to either pause the stream on the TiVo and turn off the TV and come back and watch it.  Or get a wired connection so that you can watch the streams live.

- Now Playing List disappears
This seems to be an error with the TiVo software.  But what happens is that the NPL is replaced with the directory listing of your pyTivo server.  Very odd.
Workaround - go to the bottom of the page and either select "Recently Deleted" or your pyTivo server that is listed and then hit the left arrow.  Your NPL will be back to normal

---Notes
Most of the work has been done by armooo.  Updates in this version were contributed by krkeegan.